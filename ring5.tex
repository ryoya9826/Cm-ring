\newpage
\part[Local ring and Dimension theory]{局所環と次元論}

\section{離散付値環}

局所環の例の１つに付値環というものがある．そのなかでも特に離散付値環は，後に見るように1次元Noether局所環の特徴付を与えている，重要なクラスの１つである．

\begin{defi}[付値環]\index{ふちかん@付値環}
	$A$を整域とし，$k=\Frac A$とする．任意の$0\neq x\in k$について，$x\in A$か$x^{-1}\in A$のどちらかが成り立つとき，$A$を$k$の\textbf{付値環}であるという．
\end{defi}

定義から付値環$A$は$k$上整閉であることがすぐにわかる．よって付値環は整閉整域である．

\begin{prop}
	$A$を$k$の付値環とする．このとき，$A$は局所環である．
\end{prop}

\begin{proof}
	$A$の可逆でない元全体を$\ideal{m}$とおく．これがイデアルをなすことを示そう．任意の$a\in A$と$0\neq x\in\ideal{m}$をとる．$ax\not\in\ideal{m}$と仮定すると$(ax)^{-1}\in A$となり，$x^{-1}=a(ax)^{-1}\in A$となるので矛盾する．よって$ax\in \ideal{m}$である．また$0$でない$x,y\in\ideal{m}$について，$xy^{-1}\in k$に対して仮定から$xy^{-1}\in A$または$x^{-1}y\in A$が成り立つ．$xy^{-1}\in A$のとき$x+y=(1+xy^{-1})y\in \ideal{m}$が成り立ち，$x^{-1}y\in A$のときも同様である．よって$\ideal{m}$はイデアルとなり，$A$は局所環である．
\end{proof}

次に付値環の定義のもととなった，付値と呼ばれる関数について説明しよう．

\begin{defi}[付値]\index{ふち@付値}
	$k$を体とし，$G$を全順序なAbel群とする．関数$v:k^\times\to G$が，全射であり，すべての$a,b\in k^\times$に対して；
	\begin{sakura}
		\item $v(ab)=v(a)+v(b)$
		\item $v(a+b)\geq\min (v(a),v(b))$
	\end{sakura}
	が成立するとき，$v$を\textbf{付値}(valuation)という．
\end{defi}

まず，自明な性質として$v(1)=0$であり，$v(x^{-1})=-v(x)$である．

\begin{defi}
	集合$A=\mkset{x\in k}{v(x)\geq0}\cup\{0\}$は$k$の部分環で，これを$v$の\textbf{付値環}(valuation ring)という．
\end{defi}

体の部分環であるから付値環は必ず整域である．また付値環$A$について$\Frac A=k$となることに注意しよう．これは$k$の付値環をなす．その極大イデアルは$\ideal{m}=\mkset{x\in k}{v(x)>0}$で与えられる．

次の離散付値環が特に大切である．
\begin{defi}[離散付値]\index{りさんふち@離散付値}\index{#DVR@DVR（離散付値環）}\index{りさんふちかん@離散付値環}
	$G=\Z$としたときの付値$v$を\textbf{離散付値}(discrete valuation)といい，対応する付値環を\textbf{離散付値環}(discrete valuation ring)といい，DVRと略す．このとき，便宜上$v(0)=\infty$とする．
\end{defi}

付値環についていくつかの性質を示しておこう．

\begin{lem}
	$x,y\in A$について$v(x)\geq v(y)$ならば$x\in (y)$である．特に$v(x)=v(y)$ならば$(x)=(y)$である．
\end{lem}

\begin{proof}
	$v(xy^{-1})=v(x)-v(y)\geq0$より，$xy^{-1}\in A$である．これは$x\in (y)$を導く．
\end{proof}

\begin{prop}\label{prop:離散付値環の性質}
	$A$を離散付値環とする．$I$を$A$の任意のイデアルとすると，ある$n\in\N$がとれて$I=\ideal{m}^n$である．特に$A$はPIDである．
\end{prop}

\begin{proof}
	まず，$\ideal{m}^n=(x^n)$とかけることを示そう．付値は全射であるから，$v(x)=1$となる$x\in\ideal{m}$が存在する．このとき$\ideal{m}=(x)$となることを示そう．$(x)\subset\ideal{m}$は明らかである．$y\in\ideal{m}$とすると，$v(y)\geq1$より，$v(x^{v(y)})=v(y)$が成立する．よって補題から$(y)=(x^{v(y)})\subset(x)$である．
	
	さて，$I$を$A$のイデアルとする．$v(I)=\mkset{v(y)\in\N\cup\{\infty\}}{y\in A}$は最小元を持つ．それを$n=v(y') (y'\in A)$とおこう．すると任意の$y\in A$について$v(y)\geq n=v(x^n)$より，補題から$y\in (x^n)$である．逆に$y\in(x^n)$とすると，$v(y)\geq n=v(y')$より，$y\in(y')\subset I$が従う．よって$I=(x^n)$であることがわかる．
\end{proof}

\begin{cor}
	離散付値環$A$は1次元のNoether局所整域で，$\spec A=\{0,\ideal{m}\}$である．
\end{cor}

\ref{prop:離散付値環の性質}は離散付値環の著しい特徴付けを与えており，次が成り立つ．

\begin{thm}\label{thm:DVRの特徴づけ}
	$(A,\ideal{m})$を１次元Noether局所整域とする．次は同値である．
	\begin{sakura}
		\item $A$は離散付値環である．
		\item $A$は整閉である．
		\item $\ideal{m}$は単項イデアルである．
		\item $\dim_k (\ideal{m}/\ideal{m}^2)=1$である．
		\item すべての$A$の0でないイデアルは$\ideal{m}$の冪である．
		\item ある$x\in A$が存在して，すべての0でないイデアルは$(x^k) (k\geq0)$とかける．
	\end{sakura}
\end{thm}

これを示すためにいくつかの補題を示していこう．

\begin{prop}\label{prop:局所環がm^n=0ならArtin}
	$(A,\ideal{m})$をNoether局所環とすると，次のうちどちらか１つだけが成り立つ．
	\begin{sakura}
		\item 任意の$n\geq0$について，$\ideal{m}^n\neq\ideal{m}^{n+1}$が成り立つ．
		\item ある$n>0$が存在して$\ideal{m}^n=0$である．特に，この場合$A$は0次元すなわちArtin環である．
	\end{sakura}
\end{prop}

\begin{proof}
	$\ideal{m}^n=\ideal{m}^{n+1}$となる$n$があるとする．すると，中山の補題（\ref{thm:NAK}）より$\ideal{m}^n=0$が成り立つ．任意の$P\in\spec A$について，$\ideal{m}^n\subset P$より根基をとると$\ideal{m}=P$が成り立つ．ゆえに$A$はArtinである．
\end{proof}

\begin{cor}\label{lem:DVR-A}
	$(A,\ideal{m})$を$\dim A\geq1$となるNoether局所環とすると，任意の$n$について$\ideal{m}^n\neq\ideal{m}^{n+1}$である．
\end{cor}

\begin{lem}\label{lem:Artinならnil Aは冪零}
	$A$をArtin環とすると，$\nil A$は冪零である．
\end{lem}

\begin{proof}
	DCCよりある$k>0$がとれて$(\nil A)^k=(\nil A)^{k+1}=\cdots$となる．これを$I$とおこう．$I\neq0$と仮定する．このとき$IJ\neq0$となるイデアル$J$の集合$\Sigma$は$I\in\Sigma$となり空ではない．よって$\Sigma$の極小元がとれるので，それを改めて$J$とおこう．このとき，ある$x\in J$がとれて$xI\neq0$となる．極小性より$(x)=J$であることがわかる．ここで$(xI)I=xI^2=xI\neq0$より再び極小性から$xI=(x)$となる．よって，ある$y\in I$について$xy=x$とかける．ここで$y\in I\subset\nil A$より$y^n=0$となる$n$がとれる．すると$x=xy=xy^2=\dots=xy^n=0$となり，$J=0$となるから矛盾．よって$I=0$である．
\end{proof}

\begin{prop}\label{lem:DVR-B}
	$(A,\ideal{m})$をArtin局所環とすると，$A$のすべてのイデアルが単項であることと$\dim_k(\ideal{m}/\ideal{m}^2)\leq1$であることは同値である．
\end{prop}

\begin{proof}
	$(\Longrightarrow)$は明らかなので，逆を示す．$\dim_k \ideal{m}/\ideal{m}^2=0$なら$\ideal{m}=\ideal{m}^2$となり中山の補題から$\ideal{m}=0$すなわち$A$は体となるので，示すことはない．
	
	$\dim_k \ideal{m}/\ideal{m}^2=1$と仮定すると\ref{prop:Atimac_prop_2.8}より$\ideal{m}$は単項生成である．$\ideal{m}=(x)$とする．$I$を$0$でも$A$でもない$A$のイデアルとすると，Artin環において冪零根基とJacobson根基(極大イデアルの共通部分)は等しいので，$\nil A=\ideal{m}$である．\ref{lem:Artinならnil Aは冪零}より$I\subset(\nil A)^k,I\not\subset(\nil A)^{k+1}$となる$k\in\N$がとれる．よってある$y\in I$と$a\in A$がとれて$y=ax^k，y\not\in(x^{k+1})$とできる．よって$a\not\in(x)$でなければならないので$a$は可逆である．よって$x^k\in I$となり，$I=(x^k)$となることがわかった．
\end{proof}

\begin{lem}\label{lem:DVR-C}
	$(A,\ideal{m})$を1次元Noether局所整域とする．$0$でも$A$でもない$A$のイデアル$I$について，$I$は$\ideal{m}$準素であり，特にある$n$について$\ideal{m}^n\subset I$である．
\end{lem}

\begin{proof}
	$\ideal{m}$は$A$のただ１つの0でない素イデアルなので，$\sqrt{I}=\ideal{m}$である．よって\ref{prop:sqrt{I}が極大なら準素}より$\ideal{m}$準素である．
\end{proof}

\begin{proof}[\textbf{\ref{thm:DVRの特徴づけ}の証明}]
	示すことは1次元Noether局所整域について；
	\begin{sakura}
		\item $A$は離散付値環である．
		\item $A$は整閉である．
		\item $\ideal{m}$は単項イデアルである．
		\item $\dim_k (\ideal{m}/\ideal{m}^2)=1$である．
		\item すべての$A$の0でないイデアルは$\ideal{m}$の冪である．
		\item ある$x\in A$が存在して，すべての0でないイデアルは$(x^k) (k\geq0)$とかける．
	\end{sakura}
	の同値性である．
	\begin{eqv}[6]
		\item 明らか．
		\item $0\neq a\in\ideal{m}$をとる．\ref{lem:DVR-C}より$\ideal{m}^n\subset(a),\ideal{m}^{n-1}\not\subset(a)$となる$n>0$がとれる．$b\in\ideal{m}^{n-1}$かつ$b\not\in(a)$となる$b$をとる．$x=a/b\in k$とおくと，$b\not\in(a)$より$x^{-1}\not\in A$である．$A$は整閉なので$x^{-1}$は整ではなく，\ref{prop:整拡大の特徴づけ}より$x^{-1}\ideal{m}\not\subset\ideal{m}$である．いま$x$の構成から$x^{-1}\ideal{m}\subset A$なので，$x^{-1}\ideal{m}=A$が成り立ち，$\ideal{m}=(x)$である．
		
		\item \ref{lem:DVR-A}よりわかる．
		
		\item $I$を$A$の$0$でも$A$でもないイデアルとする．\ref{lem:DVR-C}より$\ideal{m}^n\subset I$となるものがとれる．$A/\ideal{m}^n$に\ref{lem:DVR-B}を使うと，その証明から$I$は$\ideal{m}$の冪になる．
		
		\item \ref{lem:DVR-A}より$\ideal{m}\neq\ideal{m}^2$であるので，$x\not\in\ideal{m}^2$となる$x\in\ideal{m}$がとれる．仮定より$(x)=\ideal{m}^r$となる$r$がとれるが，$x$のとりかたから$r=1$でなければならない．よって$\ideal{m}=(x)$とできるので，すべてのイデアルは$(x^k)$の形に書ける．
		
		\item $(x)=\ideal{m}$なので，\ref{lem:DVR-A}より$(x^k)\neq(x^{k+1})$である．よって0でない任意の$a\in A$について，唯１つ$(a)=(x^k)$となる$k$が定まる．$v(a)=k$とし，$v(ab^{-1})=v(a)-v(b)$として$v$を$k$全体に定義することで離散付値環となる．
	\end{eqv}
\end{proof}

\section{Dedekind整域}

\begin{defi}[Dedekind整域]\index{#Dedekindせいいき@Dedekind整域}
	$A$を整域とする．すべての$A$の0でも$A$でもないイデアル$I$が有限個の素イデアルの積に(一意的に)かけるとき，$A$をDedekind\textbf{整域}という．
\end{defi}

この条件は$\Z$の素因数分解の拡張を与えるために素イデアルが考案されたという歴史的経緯を考えると，素因数分解ができる環，というように捉えることができ，$\Z$のよい一般化になっている．この節ではDedekind環の公理的特徴づけを与えよう．

まず，判定方法として1次元のNoether整閉整域ならばDedekind整域であることを示そう．実際にはこれが同値条件を与えていることを後に示す（\ref{thm:Dedekind同値条件}）．

\begin{lem}\label{lem:Dedekind-1}
	$A$を環，$P,P_0\in\spec A$とし，$
	q_0$を$P_0$準素イデアルとする．$P\neq P_0$であるとき，$q_0A_P=A_P$が成り立つ．
\end{lem}

\begin{proof}
	$x\not\in P$となる$x\in P_0$をとる．このとき$P_0=\sqrt{q_0}$なので，$x^n\in q_0$となる$n\geq1$がとれる．また$x^n\not\in P$なので，$x^n/1\in q_0A_P$は可逆である．よって$q_0A_P=A_P$が成り立つ．
\end{proof}

\begin{lem}\label{lem:Dedekind-2}
	環$A$のイデアル$I,J$について，$I$と$J$が互いに素であることは$\sqrt{I}$と$\sqrt{J}$が互いに素であることと同値．
\end{lem}

\begin{proof}
	逆は明らかなので根基が互いに素なら$I,J$も互いに素であることを見れば十分である．$x+y=1$となる$x\in\sqrt{I},y\in\sqrt{J}$をとる．適当な$n,m$をとって$x^n\in I，y^m\in J$としたとき，$1=(x+y)^{n+m}$であって，これは$k+l=m+n$となる$k,l$についての$x^ky^l$の線形和である．いま$k<n$なら$m<l$が成り立ち，常に$x^ky^l\in I\cup J$が成り立つ．よって各項は$I$か$J$に含まれるから，$I$と$J$は互いに素である．
\end{proof}

\begin{thm}\label{thm:1dimNoether整閉整域ならDedekind}
	$A$が1次元Noether整閉整域ならば$A$はDedekind整域である．
\end{thm}

\begin{proof}
	$I$を$A$の0でも$A$でもないイデアルとする．$A$はNoetherなので，$I=\cap q_i$と無駄のない準素分解ができる．$P_i=\sqrt{q_i}$とおく．このとき$A$は1次元の整域だから$P_i$は極大イデアルであることに注意する．特に$IA_{P_i}$は$A_{P_i}$の0でないイデアルになる．ここで；
	\[IA_{P_i}=\cap (q_iA_{P_i})\]
	であり，$i\neq j$のとき$P_i\neq P_j$なので\ref{lem:Dedekind-1}より$q_jA_{P_i}=A_{P_i}$である．よって$IA_{P_i}=q_iA_{P_i}$が成り立つ．ここで$A_{P_i}$は1次元のNoether局所整閉整域なので，\ref{thm:DVRの特徴づけ}より $q_iA_{P_i}=IA_{P_i}=P_i^{n_i}A_{P_i}$が成り立つ．ここで$\sqrt{P_i^{n_i}}=P_i$であり，$P_i$は極大なので\ref{prop:sqrt{I}が極大なら準素}より$P_i^{n_i}$も$P_i$準素イデアルである．すると；
	\[q_i=q_iA_{P_i}\cap A=P_i^{n_i}A_{P_i}\cap A=P_i^{n_i}\]
	である．ここで$P_i$たちは極大なので互いに素である．よって\ref{lem:Dedekind-2}より$q_i$たちも互いに素なので，中国剰余定理から$I=\prod P_i^{n_i}$とかける．
\end{proof}

逆向きの証明を行うために，分数イデアルという概念を導入しよう．

\begin{defi}[分数イデアル]\index{ぶんすういである@分数イデアル}
	$A$を整域とし，$k$をその商体とする．$k$の0でない$A$部分加群$M$で，ある$0\neq x\in A$が存在して$xM\subset A$となっているとき，$M$を$A$の\textbf{分数イデアル}(fractional ideal)という．
\end{defi}

通常の$A$のイデアルは分数イデアルであることに注意せよ．ここでは$A$の通常のイデアルを区別する目的で\textbf{整イデアル}と呼ぶことがある．

$k$の有限生成$A$部分加群$M$は分数イデアルである．なぜならば，生成元たちを\quo{通分}して，その分母をかければよいからである．

\begin{defi}[可逆イデアル]\index{かぎゃくいである@可逆イデアル}
	$M,N$を$k$の$A$部分加群とする．$MN=A$となっているとき，$M,N$を\textbf{可逆イデアル}(invertible ideal)という．
\end{defi}
	実際には，$M$が可逆イデアルであるとき，$MN=A$となる$N$は$(A:M)=\mkset{u\in k}{uM\subset A}$に一致する．実際$N\subset (A:M)=(A:M)MN\subset AN=N$が成り立つ．特に$(A:M)=M^{-1}$と略記する．
	
	一般の分数イデアル$M$について同様に$M^{-1}$を考えると$MM^{-1}$は$A$の整イデアルになる．次の補題から可逆イデアルは分数イデアルであるから，分数イデアル$M$が可逆であることは$M(A:M)=A$となること，と定式化できる．

\begin{lem}
	$M$が可逆なら有限生成であり，分数イデアルとなる．
\end{lem}

\begin{proof}
	 $MM^{-1}=A$であるので，$x_i\in M$と$y_i\in M^{-1}$がとれて$\sum x_iy_i=1$が成立する．ここで，任意の$x\in M$に対して$y_ix\in A$であるから，$x=\sum(y_ix)x_i$により$M$は$x_i$たちによって生成される．
\end{proof}

可逆性は局所的な性質であることを示そう．
	
\begin{prop}\label{prop:可逆性は局所的}
	分数イデアル$M$について，次は同値である．
	\begin{sakura}
		\item $M$は可逆である．
		\item $M$は有限生成で，任意の$P\in\spec A$について$M_P$は可逆．
		\item $M$は有限生成で，任意の$\ideal{m}\in\spm A$について$M_{\ideal{m}}$は可逆．
	\end{sakura}
\end{prop}

\begin{proof}
	\begin{eqv}[3]
		\item $M$は可逆なので有限生成である．ここで$M(A:M)=A$であるから，\ref{prop:イデアル商は局所化と可換}より$A_P=M_P(A_P:M_P)$が成り立つ．
		\item 明らか．
		\item $I=M(A:M)$とおくと，これは$A$の整イデアルとなる．$I\neq A$とすると，$I\subset \ideal{m}$となる極大イデアル$\ideal{m}$について$M_{\ideal{m}}$は可逆だから$I_{\ideal{m}}=M_{\ideal{m}}(A_{\ideal{m}}:M_{\ideal{m}})=A_{\ideal{m}}$が成り立つ．よって$I\subset\ideal{m}$ではありえず，$I=A$である．
	\end{eqv}
\end{proof}

\begin{lem}\label{lem:局所の場合の可逆性}
	$(A,\ideal{m})$を局所整域とする．$A$の0でないすべてのイデアルが可逆ならば，$A$はDVR，すなわち1次元局所Noether整閉整域である．
\end{lem}

\begin{proof}
	可逆な分数イデアルは有限生成なので，$A$はNoether環である．$A$のすべてのイデアルが$\ideal{m}$の冪になっていればよい．$\Sigma$を$\ideal{m}$の冪でない$A$のイデアル全体の集合とし，これが空でないと仮定する．$I$を$\Sigma$の極大元とする．このとき$I\subsetneq\ideal{m}$でなければならない．よって$\ideal{m}^{-1}I\subsetneq \ideal{m}^{-1}\ideal{m}=A$もイデアルで，$I\subset \ideal{m}^{-1}I$である．ここで，もし$\ideal{m}^{-1}I=I$ならば中山の補題（\ref{thm:NAK}）より$I=0$となってしまうから，$I\subsetneq m^{-1}I$である．よって極大性から$\ideal{m}^{-1}I$は$\ideal{m}$の冪になるが，これは$I$が$\ideal{m}$の冪であることを即座に導き矛盾．
\end{proof}

\begin{prop}\label{prop:すべてのイデアルが可逆ならば1-dimNoether整閉整域}
	$A$を整域とする．$A$の0でないすべてのイデアルが可逆ならば，$A$は1次元Noether整閉整域である．
\end{prop}

\begin{proof}
	補題と同様に$A$はNoether環である．$A_P$は局所整域となる．$A_P$のイデアルがすべて可逆であることを示そう．$I$を$A_P$のイデアルとすると，$I\cap A$は$A$のイデアルなので可逆である．よって，$I$はこれを局所化したものだから\ref{prop:可逆性は局所的}より可逆．\ref{lem:局所の場合の可逆性}より$A_P$は1次元局所Noether整閉整域である．よって$\idht P=\dim A_P=1$より$\dim A=1$が従い，\ref{prop:整域の整閉性はlocal}より$A$は整閉であることがわかる．
\end{proof}

\begin{thm}\label{thm:Dedekind同値条件}
	$A$を整域とする．$A$がDedekind整域であることと，$A$が1次元Noether整閉整域であることは同値である．
\end{thm}

\begin{proof}
	\ref{thm:1dimNoether整閉整域ならDedekind}と\ref{prop:すべてのイデアルが可逆ならば1-dimNoether整閉整域}より，$A$がDedekind整域ならば$A$の0でないすべてのイデアルが可逆であることを示せばよい．以下の証明は\cite{matsu}に拠っている．
	
	\begin{step}
		\item $M,N$を0でない分数イデアルとする． $M,N$が可逆であることと$MN$が可逆であることは同値である．
		
		$MN=B$とおく．$M,N$が可逆なら$B$が可逆なことは明らかなので，逆を示そう．$B$が可逆であると仮定する．簡単な計算で$M^{-1}N^{-1}\subset B^{-1}$であることがわかる．また$B^{-1}M\subset N^{-1},B^{-1}N\subset M^{-1}$であるので，$B^{-1}=B^{-1}B^{-1}B=(B^{-1}M)(B^{-1}N)\subset M^{-1}N^{-1}$が成立する．よって$B^{-1}=M^{-1}N^{-1}$であるから；
		\[A=BB^{-1}=(MM^{-1})(NN^{-1})\]
		が従う．ここで$MM^{-1}\subset A$であり，これは$A$のイデアルを成すので$MM^{-1}=NN^{-1}=A$でなければならない．
	
		\item $0\neq P\in\spec A$に対して，$P\subset I$となるイデアル$I$について$IP=P$である．
		
		$a\not\in P$をとる．$I=P+(a)$の形のときに示せば十分である．$I^2$と$P+(a^2)$を素イデアル分解して$I^2=P_1\dots P_r,P+(a^2)=Q_1\dots Q_s$とする．$P\subset I\subset P_i,Q_j$なので，$\bar{A}=A/P$における像$\bar{P_i},\bar{Q_j}$はすべて0でない．このとき；
		\[\bar{P_1}\dots\bar{P_r}=(\bar{a}^2)=\bar{Q_1}\dots\bar{Q_s}\tag{$\ast$}\]
		となる．$\bar{P_i}$が$\bar{P_i}$のなかで極小であるとしてよい．ここで$\bar{Q_j}$のすべてが$\bar{P_i}$に含まれないと仮定すると，$x_j\in \bar{Q_j}-\bar{P_1}$がとれる．一方で$x_1\dots x_s\in \bar{Q_1}\dots\bar{Q_s}=\bar{P_1}\dots\bar{P_r}\subset\bar{P_1}$より，$\bar{P_1}$が素であることに矛盾する．よって$\bar{Q_1}\subset\bar{P_1}$としてよい．ここで$\bar{P_1}\dots\bar{P_r}\subset\bar{Q_1}$だから，同様にして$\bar{P_i}\subset\bar{Q_1}$となる$i$がある．このとき$\bar{P_1}$の極小性から$\bar{P_1}=\bar{Q_1}$である．
		
		また，$(\ast)$において$(\bar{a}^2)$は可逆なイデアルなので，Step1 から$\bar{P_i},\bar{Q_j}$はすべて可逆である．よって両辺に$\bar{P_1}{}^{-1}$をかけることで$\bar{P_2}\dots\bar{P_r}=\bar{Q_2}\dots\bar{Q_s}$がわかる．上と同様にして$r=s$であり，$\bar{P_i}=\bar{Q_i}$となるように並び替えることができることがわかる．
		
		よって$P_i=Q_i$が従うから，$P+(a^2)=P^2+aP+(a^2)$である．よって，任意の$x\in P$は；
		\[x=y+az+a^2t\quad y\in P^2，z\in P，t\in A\]
		とかけるが，このとき$a^2t\in P$で$a\not\in P$から$t\in P$である．よって$P\subset P^2+aP=IP\subset P$であるから，主張が従う．
		
		\item $0\neq x\in A$に対して，$(x)=P_1\dots P_r$と素イデアル分解したとき，各$P_i$は極大イデアルである．
		
		実際，イデアル$I$が$P_i\subset I$を満たすならStep2より$IP_i=P_i$であるが，$P_i$はStep1より可逆だから$I=A$である．
		
		\item すべての$A$のイデアルは可逆である．
		
		任意の0でも$A$でもないイデアル$I$について，$I=P_1\dots P_r$と素イデアル分解する．各$P_i$が可逆なら$I$も可逆になるので，すべての$0\neq P\in\spec A$が可逆ならよい．
		
		$0\neq P\in\spec A$と$0\neq x\in P$をとる．Step3より$(x)=Q_1\dots Q_s$と分解したとき各$Q_i$は極大イデアルである．ここでどれかの$Q_i$は$P$に含まれるから，$Q_i=P$が成り立つ．よって$P$は可逆である．
	\end{step}
\end{proof}

\section{Krullの次元定理}
\ref{defi:Krull次元}で環のKrull次元を定義した．素イデアルの長さをもってして環の大きさを計ったわけであるが，この節ではPoincar\'e\textbf{級数}を用いた別の\quo{計りかた}を，次数付きNoether環に，そして\ref{defi:随伴次数環}で定義した随伴次数環を用いてNoether局所環に対して考えよう．
まず，一般に\textbf{加法的関数}というものを定義する．
\begin{defi}[加法的関数]\index{かほうてきかんすう@加法的関数}
	ある加群の族$\{M_i\}$上定義された$\Z$への関数$\lambda$で，任意の短完全列；
	\[\ses{M_1}{M_2}{M_3}\]
	について，$\lambda(M_1)-\lambda(M_2)+\lambda(M_3)=0$であるとき，$\lambda$を\textbf{加法的}(additive)関数という．
\end{defi}

さて，$A=\bigoplus_{n\geq0}A_n$を次数付きNoether環とする．このとき，$A=A_0[x_1,\dots,x_s]$とできる（\ref{prop:次数付き環のNoether性}）．ここで$x_i$を斉次元で取り替え，それらの次数を$k_i$としよう．また，$M=\bigoplus_{n\geq0}M_n$を有限生成$A$加群とし，斉次な生成元を$m_1,\dots,m_t$，それぞれの次数は$r_1,\dots,r_t$とする．このとき$M_n$のすべての元は$f_i\in A_{n-r_i}$によって$\sum f_im_i$の形で書けるので，$M_n$は有限生成$A_0$加群である．以後，しばらくはこの記号で話をすすめる．

\begin{defi}[Poincar\'e級数]\index{#Poincareきゅうすう@Poincar\'e級数}
	次数付き環$A$，次数付き有限生成$A$加群$M$について，$\lambda$をすべての有限生成$A_0$加群からなる集合族上の加法的関数とする．このとき；
	\[P(M,t)=\sum_{n=0}^\infty \lambda(M_n)t^n\]
	を$M$のPoincar\'e\textbf{級数}(Poincar\'e series)という．
\end{defi}
Poincar\'e級数の考察には，次の定理により与えられる表示が強力である．

\begin{thm}[Hilbert，Serre]
	$P(M,t)$は有理関数である．特に$\Z$係数の多項式$f(t)\in\Z[t]$が存在して；
	\[P(M,t)=\frac{f(t)}{\prod_{i=1}^s(1-t^{k_i})}\]
	が成り立つ．
\end{thm}

\begin{proof}
	$A=A_0[x_1,\dots,x_s]$とおく．$s$についての帰納法で示す．
	\begin{step}
		\item $s=0$のとき．
		
		$A=A_0$なので，$M$は有限生成$A_0$加群となり，十分大きな$M_n$について$M_n=0$である．よって$P(M,t)$は多項式となる．
		
		\item $s-1$まで正しいとする．
		
		$\begin{tikzcd}
			M_n\nxcell[\times x_s]M_{n+k_s}
		\end{tikzcd}$の核，余核を$K_n,L_{n+k_s}$とおくと；
		\[\begin{tikzcd}
			0\nxcell K_n\nxcell M_n\nxcell[\times x_s]M_{n+k_s}\nxcell L_{n+k_s}\nxcell0
		\end{tikzcd}\]
		が完全である．$K=\bigoplus K_n,L=\bigoplus L_n$とおくと，$M$は有限生成$A$加群なので，その部分加群，剰余加群である$K，L$も有限生成である．どちらも$x_s$で零化されるので$A_0[x_1,\dots,x_{s-1}]$加群である．ここで$\lambda$が加法的なので，$(\ast)$において；
		\[\lambda(K_n)-\lambda(M_n)+\lambda(M_{n+k_s})-\lambda(L_{n+k_s})=0\]
		である．$t^{n+k_s}$をかけて，$n$について加えると，補正項を$g(t)$として；
		\[t^{k_s}P(K，t)-t^{k_s}P(M,t)+P(M,t)-P(L，t)-g(t)=0\]
		となり；
		\[(1-t^{k_s})P(M,t)=-t^{k_s}P(K，t)+P(L，t)+g(t)\]
		となるので，帰納法の仮定から条件を満たす$f(t)$が見つかる．
	\end{step}
\end{proof}

もっとも簡単な，かつ多項式のように重要な$k_1=\dots=k_s=1$の場合を考えてみよう．このとき$P(M,t)=f(t)(1-t)^{-s}$とかけるが，$f(1)=0$ならば約分して$f$をとりかえることで；
\[P(M,t)=\frac{f(t)}{(1-t)^d},\quad f(1)\neq0\]
とできる．ここで$d$は$P(M,t)$の$1$における極の位数であることに注意する．$(1-t)^{-1}=1+t+t^2+\cdots$の両辺を$t$で微分して(あるいは$(1+t+^t2+\cdots)^{d}$を展開して)；
\[(1-t)^{-d}=\sum_{n=0}^\infty\binom{d+n-1}{d-1} t^n\]
を得る．よって，$f(t)=\sum_{k=0}^N a_kt^k$とすると；
\[\lambda(M_n)=a_0\binom{d+n-1}{d-1}+a_1\binom{d+n-2}{d-1}+\dots+a_k\binom{d+n-k-1}{d-1}\tag{$\ast$}\]
とかけている($m<d-1$なら$\binom{m}{d-1}=0$とする($\ast$)の先頭項(最高次の係数と次数)は$f(1)/(d-1)! n^{d-1}$である．これをまとめると次のようになる．

\begin{defi}[Hilbert多項式]\index{#Hilbertたこうしき@Hilbert多項式}\label{defi:Hilbert多項式}
	$k_1=\dots=k_s=1$のとき，有理係数で$d-1$次の($n$に関する)多項式$\varphi_M(n)$が存在して，$N
	\leq n$ならば$\lambda(M_n)=\varphi_M(n)$が成り立つ．$\varphi_M$を，$M$の$\lambda$に関するHilbert\textbf{多項式}(function，polymonial)という．
\end{defi}

$A_0$がArtin（特に体）のとき，$M$は有限生成だからArtinかつNoether的なので\ref{prop:有限な組成列の同値条件}より組成列の長さ$l(M)$は有限である．そして$l(M)$は加法的である（確かめよ）．$x_i$を$A_0$上の不定元として$A=A_0[x_1,\dots,x_s]$とすると，$A_n$は$x_1^{m_1}\dots x_s^{m_s} (\sum m_i=n)$により生成される．$n$次の単項式は$\binom{n+s}{s}$個あるので，$l(A_n)=l(A_0)\binom{n+s}{s}$となり；
\[\varphi_A(n)=\frac{l(A_0)}{s!}(n+s)(m+s-1)\dots(n+1)\]
である．

次に$(A,\ideal{m})$をNoether局所環，$M$を有限生成$A$加群とし，随伴次数環について考えよう．$I$を$\ideal{m}$準素イデアルとし，$G(A)=(G_I(A)=)\bigoplus I^n/I^{n+1},G(M)=\bigoplus M_n/M_{n+1}$を考える．このとき$G_0(A)=A/I$は$I$が$\ideal{m}$準素なのでArtinである．ここでフィルターについて思い出してみよう．

\begin{prop}\label{prop:フィルターとHilbert多項式}
	上の設定のもとで，$\{M_n\}$を$M$の安定している$I$フィルターとする．$x_1,\dots,x_s$を$I$の極小の生成系とすると；
	\begin{sakura}
		\item $l(M/M_n)$は有限である．
		\item すべての十分大きな$n$について，次数が$s$以下の多項式$g(n)$が存在して$l(M/M_n)=g(n)$となる．
		\item $g(n)$の先頭項は$M$と$I$のみに依存する（フィルター$\{M_n\}$には依存しない）．
	\end{sakura}
	が成り立つ．また(i),(ii)は$\{M_n\}$の安定性を仮定せずに成り立つ．
\end{prop}

\begin{proof}
	\begin{sakura}
		\item \ref{prop:G(hat{A})はNoether}，\ref{prop:フィルターが安定していればG(M)は有限生成}より$G(A)$はNoetherで，$G(M)$は有限生成$G(A)$加群である．各$G_n(M)=M_n/M_{n+1}$は$I$で零化されるのでNoether $A/I$加群であるから，$A/I$はArtinなので$l(M_n/M_{n+1})$は有限である．ここで$l(M/M_n)=\sum_{i=1}^n l(M_{i-1}/M_i)$であるから，$l(M/M_n)$も有限である．
		\item $I=(x_1,\dots,x_s)$のとき，$G(A)=A/I[\bar{x_1},\dots,\bar{x_s}]$であった．よって \ref{defi:Hilbert多項式}の条件を満たし，次数が$s-1$次以下の$\varphi_{G(M)}(n)$が存在して，$l(M_n/M_{n+1})=\varphi_{G(M)}(n)$となる．(i)より$l(M/M_{n+1})-l(M/M_n)=\varphi_{G(M)}(n)$なので，題意が従う．
		\item $\{M_n'\}$を$M$の安定している$I$フィルターとすると，$g'(n)=l(M/M_n')$とおく．\ref{lem:安定しているフィルターは有界な差を持つ}より$\{M_n\},\{M_n'\}$は有界な差を持つ．よって，ある$n_0\geq0$が存在して，すべての$n$について；
		\[g'(n)\leq g(n+n_0),g(n)\leq g'(n+n_0)\]
		が成り立つ．はさみうちの原理から$\lim_{n\to\infty} g(n)/g'(n)=1$となり，先頭項は一致する．
	\end{sakura}
\end{proof}

フィルター$\{I^n M\}$に対応する$g(n)$は$\chi_I^M(n)$で表される．

\begin{defi}[特性多項式]\index{とくせいたこうしき@特性多項式}
	$M=A$のとき，$\chi_I(n)(=\chi_I^A(n))$を$\ideal{m}$準素イデアル$I$の\textbf{特性多項式}(characteristic polynomial)という．
\end{defi}

$\chi_I(n)$の次数は$I$の極小の生成系の個数以下であることに注意する．

\begin{prop}
	$I,I'$を$\ideal{m}$準素イデアルとすると，$\chi_I(n)$と$\chi_I'(n)$の次数は等しい．
\end{prop}

\begin{proof}
	$\deg\chi_I(n)=\deg\chi_{\ideal{m}}(n)$を示せばよい．$A$がNoetherで$I$が$\ideal{m}$準素なので$\sqrt{I}=\ideal{m}$だから，ある$r\geq0$が存在して$\ideal{m}^r\subset I\subset\ideal{m}$である．よって$\ideal{m}^{nr}\subset I^n\subset\ideal{m}^n$なので；
	\[\chi_{\ideal{m}}(n)\leq\chi_I(n)\leq\chi_{\ideal{m}^r}(nr)\]
	である．右辺と左辺の次数は等しいので題意が成り立つ．
\end{proof}

$\deg\chi_I(n)=d(A)$とかく．また，先程まで$s$とかいていた$I$の極小の生成系の個数を$\delta(A)$とかくことにする．$d(A)$を$A$のHilbert-Samuel次元，$\delta(A)$を$A$の座標次元と呼ぶ．この節の残りの目標はNoether局所環$(A,\ideal{m})$について，次のKrullの次元定理；
\begin{thm}[Krullの次元定理]\index{#Krullのじげんていり@Krullの次元定理}\label{thm:Krullの次元定理}
	$(A,\ideal{m})$をNoether局所環とする．$\chi_{\ideal{m}}(n)=l(A/\ideal{m}^n)$の次数を$d(A),A$の$\ideal{m}$準素イデアルの極小の生成系の個数を$\delta(A)$とおくと；
	\[\dim A=d(A)=\delta(A)\]
	が成り立つ．
\end{thm}

を示すことである．先程も注意したように，$\delta(A)\geq d(A)$が成り立っている．次に$d(A)\geq\dim A$を示していこう．

\begin{lem}\label{lem:商の特性多項式を上から抑える}
	Noether局所環$(A,\ideal{m})$と$\ideal{m}$準素イデアル$I$について，$M$を有限生成$A$加群，$x\in A$を$M$の零因子でない元として$M'=M/xM$とおく．このとき$\deg\chi_I^{M'}\leq\deg\chi_I^M-1$である．特に，$M=A$としたとき$d(A/(x))\leq d(A)-1$が成り立つ．
\end{lem}

\begin{proof}
	$N=xM$とおき，$N_n=N\cap I^nM$とする．このとき；
	\[\ses{N/N_n}{M/I^nM}{M'/I^nM'}\]
	が完全である．Artin--Reesの補題（\ref{prop:Artin--Reesの補題}）より，$\{N_n\}$は$N$の(安定している) $I$フィルターだから，\ref{prop:フィルターとHilbert多項式}より，十分大きな$n$について$l(M/M_n)=g(n)$となる$g(n)$がとれる．同様に，十分大きな$n$をとれば$g(n)-\chi_I^M(n)+\chi_I^{M'}(n)=0$が成り立つ．また，仮定より$N=xM\cong M$であるから，\ref{prop:フィルターとHilbert多項式}(iii)より$\deg g(n)=\deg\chi_I^M$であるので，主張が従う．
\end{proof}

\begin{prop}\label{prop:d(A)geq dim A}
	$d(A)\geq\dim A$である．
\end{prop}

\begin{proof}
	$d(A)=d$についての帰納法で示す．
	\begin{step}
		\item $d=0$のとき．
		
		十分大きな$n$に対して$l(A/\ideal{m}^n)$は定数である．これは$\ideal{m}^n=\ideal{m}^{n+1}$であるので，中山の補題（\ref{thm:NAK}）より$\ideal{m}^n=0$である．よって\ref{prop:局所環がm^n=0ならArtin}から$A$はArtinであり，$\dim A=0$である．
		
		\item $d-1$まで正しいとする．
		
		$\dim A=r$とおき，$P_0\subset P_1\subset\dots\subset P_r$を$A$の素イデアルの列とする．$x\in P_1\setminus P_0$をとる．$A'=A/P_0$とおき，$x'$を$x$の$A'$への像とする．$A'$は整域で，$x'\neq0$であるので，\ref{lem:商の特性多項式を上から抑える}より$d(A'/(x')))\leq d(A')-1$が成り立つ．ここで$\ideal{m}'$を$\ideal{m}$の$A'$への像とすると，$(A',\ideal{m}')$はNoether局所環である．ここで$l(A'/\ideal{m}')\leq l(A/\ideal{m})$であるので$d(A')\leq d(A)$である．よって$d(A'/(x'))\leq d(A)-1$であるから，帰納法の仮定から$\dim A'/(x')\leq d-1$である．$P_1,\dots,P_r$の$A'/(x')$への像は長さ$r-1$の素イデアルの列をなし，$r\leq d$が成り立つ．よって示された．
	\end{step}
\end{proof}

\begin{cor}
	Noether環$A$の素イデアル$P$について$\idht P<\infty$である．
\end{cor}

\begin{proof}
	Noether局所環$(B,\ideal{m})$について，$\delta(B)<\infty$が明らかに成り立つ．よって$\dim B<\infty$である．よって，Noether環$A$とその素イデアル$P$について，$A_P$は局所環となるので，$\idht P=\dim A_P<\infty$である．
\end{proof}

しかしながら，無限次元のNoether環（整域）が存在することに注意しなければならない（\ref{ex:無限次元Noether環}）．

\begin{lem}
	$A$を$1\leq\dim A$なる有限次元Noether環とする．このとき，単元でない$x\in A$が存在して，$\dim A/(x)<\dim A$が成り立つ．
\end{lem}

\begin{proof}
	$P\in\spec A$を$\idht P>0$となるものとする．ここで，$A$がNoetherなので$A$の極小な素イデアルは有限個しか存在しない（\ref{cor:Noether環の極小素イデアルは有限個}）．よって，それらを$P_1,\dots, P_n$とすると，すべての$i$について$P\not\subset P_i$であるから，Prime avoidance（\ref{lem:Prime avoidance}）より$P\not\subset\bigcup_{i=1}^nP_i$が成り立つ．よって$x\in P\setminus\bigcup P_i$をとると，$\dim A/(x)<\dim A$である．

\end{proof}
\begin{prop}\label{prop:dim A geq delta(A)}
	$(A,\ideal{m})$をNoether局所環とすると，$\dim A\geq s$個の元からなる$\ideal{m}$準素イデアル$I$が存在する．特に$\delta(A)\leq\dim A$である．
\end{prop}

\begin{proof}
	$\dim A=d$についての帰納法で示す．
	
	\begin{step}
		\item $d=0$のとき．
		
		$A$はArtinなので，\ref{prop:局所環がm^n=0ならArtin}より，ある$n$が存在して$\ideal{m}^n=0$である．よって$\ideal{m}=\nil A$が成り立ち，$0$は$\ideal{m}$準素イデアルである．ゆえに$\delta(A)=0$がわかる．
		
		\item $d-1$まで正しいとする．
		
		補題より，単元でない$x\in A$で，$\dim A/(x)\leq d-1$となるものがとれる．$A'=A/x$とおくと，これはNoether局所環である．$d'=\dim A'$とすると，帰納法の仮定より$d'\geq s$個の元で生成される$\ideal{m}'$準素イデアル$I'=(x_1',\dots,x_s')$が存在する．ここで$I=(x_1,\dots,x_s，x)$が$\ideal{m}$準素イデアルであること，すなわち$\ideal{m}\subset\sqrt{I}$であることを示そう．
		
		任意の$y\in\ideal{m}$をとる．もし$y\in (x)$のときは$y\in I$であるので，$y\not\in(x)$すなわち$y'$を$A'$への像とすると$y'\neq0$としてよい．$I'$は$\ideal{m}'$準素なので，ある$n$が存在して$y'^n\in I'$である．よって$y'^n=a_1'x_1'+\dots+a_s'x_s'$とかける．よって$y^n-a_1x_1+\dots+a_sx_s\in (x)$であるから，$y^n\in I$である．
		
		よって$\delta(A)=s+1\leq d'+1\leq (d-1)+1=d$であることがわかった．
	\end{step}
\end{proof}

以上より，\ref{prop:フィルターとHilbert多項式}，\ref{prop:d(A)geq dim A}，\ref{prop:dim A geq delta(A)}によってKrullの次元定理（\ref{thm:Krullの次元定理}）が示された．

\section{Krullの次元定理の系たち}

準素イデアルの節で注意しておいたことだが，極小素イデアルについてもう一度注意しておこう．Noether環$A$とそのイデアル$I$について$V(I)$の極小元，つまり$I$を含む素イデアルで極小なものは$\ass(A/I)$の元であるから有限個である．また$I=\bigcap q_i$と準素分解したとき，$P=\sqrt{q_i}$となる$i$が存在する．
\begin{thm}[Krullの標高定理]\index{#Krullのひょうこうていり@Krullの標高定理}\label{thm:Krullの標高定理}
	$A$をNoether環とし，$\nitem{f}\in A$とする．イデアル$(\nitem{f})$の極小素イデアル$P$について$\idht P\leq n$が成り立つ．
\end{thm}

\begin{proof}
	$P$のとりかたから，$(\nitem{f})=\bigcap_{i=1}^m q_i$と準素分解したとき，$P=\sqrt{q_j}$となる$j$がある．ここで$A_P$において$(\nitem{f})A_P$が$PA_P$準素イデアルであることを示そう．そのために$\sqrt{(\nitem{f})A_P}=PA_P$を示せば十分である．任意の$x/s\in PA_P$をとる．$x\in P=\sqrt{q_j}$より，ある$n$がとれて$x^n\in q_j$である．ここで$x^n\not\in q_i$となる$i$たちをまとめて$i_1,\dots,i_r$とする．$\sqrt{q_i}=P_i$とおくと，$P$は極小なので$P_i\not\subset P$が成り立つ．よって$\nitem[r]{i}$について，ある$y_k\in P_{i_k}$が存在して$y_k\not\in P$である．$y_k\in\sqrt{q_{i_k}}$よりある$n_k$が存在して$y_k^{n_k}\in q_{i_k}$である．$n，\nitem[r]{n}$の最大値を$n$ととりなおし，$xy_1\dots y_r$を$x$，$sy_1\dots y_r$を$s$と置き直すと$x^n=\bigcap_{i=1}^m q_i=(\nitem{f})$であり，$s\not\in P$であるので，$x/s\in\sqrt{(\nitem{f})A_P}$である．よってKrullの次元定理から$\idht P=\dim A_P\leq n$となる．
\end{proof}

\begin{cor}[Krullの単項イデアル定理]\index{#Krullのたんこういであるていり@Krullの単項イデアル定理}
	$A$をNoether環とし，$x$を$A$の零因子でも単元でもない$A$の元とする．このとき，$(x)$のすべての極小素イデアル$P$について$\idht P=1$である．
\end{cor}

\begin{proof}
	標高定理より$\idht P\leq1$である．$\idht P=0$であるとすると，$\spec A_P=\{P\}$であるので，$\nil A_P=PA_P$である．$x\in P$であるので，$x$は零因子でないことに矛盾する．よって$\idht P=1$である．
\end{proof}

\begin{thm}[Krullの標高定理の逆]
	$A$をNoether環とし，$P\in\spec A$が$\idht P=n$であったとすると，ある$a_1,\dots,a_n\in P$が存在して$P$は$(a_1,\dots,a_n)$の極小素イデアルとなる．
\end{thm}

\begin{proof}
	$A_P$は$n$次元局所環なので，$n$個の元で生成される$PA_P$準素イデアル$(x_1/s_1,\dots,x_n/s_n)$が存在する．このとき$PA_P$は$(x_1/s_1,\dots,x_n/s_n)$の極小素イデアルになる．ここで$a_i=s_1\dots s_n(x_i/s_i)\in A$とおくと，$s_1\dots s_n$は$A_P$の単元なので，イデアルとして$(a_1,\dots,a_n)A_P=(x_1/s_1,\dots,x_n/s_n)$である．よって$P$は$(a_1,\dots,a_n)$の極小素イデアルとなる．
\end{proof}

\begin{prop}\label{prop:標高定理の系}
	$A$をNoether環とし，$P\in\spec A$が$(a_1,\dots,a_n)$の極小素イデアルなら$\idht (P/(a_1,\dots,a_i))=n-i (1\leq i\leq n)$である．
\end{prop}

\begin{proof}
	$P$の$\bar{A}=A/(a_1,\dots,a_n)$における像を$\bar{P}$とおく．$\idht \bar{P}=r$としよう．$\bar{A}$において$\bar{P}$は$(\bar{a_{i+1}},\dots,\bar{a_n})$の極小素イデアルである．よってKrullの標高定理から$r\leq n-i$である．
	
	また，Krullの標高定理の逆より$\bar{x_1},\dots,\bar{x_r}\in\bar{A}$が存在して$\bar{P}$は$(\bar{x_1},\dots,\bar{x_r})$の極小素イデアルである．よって$P$は$(a_1,\dots,a_i，x_1,\dots,x_r)$の極小素イデアルとなり，$n\leq r+i$である．よって$r=n-i$が示された．
\end{proof}

\begin{prop}\label{prop:dim A/xA=dim A-1}
	Noether局所環$(A,\ideal{m})$と$A$の零因子でない$x\in\ideal{m}$について，$\dim A/(x)=\dim A-1$が成り立つ．
\end{prop}

\begin{proof}
	$d=\dim A/(x)$とおく．\ref{lem:商の特性多項式を上から抑える}より$d\leq \dim A-1$である．一方，$\ideal{m}$の$A/(x)$への像を$\bar{\ideal{m}}$とすると，局所環$(A/(x),\bar{\ideal{m}})$において$d$個の元で生成される$\bar{\ideal{m}}$準素イデアルがある．$x_1,\dots,x_d\in A$をそれらの$A/(x)$への像$\bar{x_i}$が$\bar{\ideal{m}}$準素イデアルを生成するような元としよう．このとき$(x，x_1,\dots,x_d)$は$\ideal{m}$準素イデアルとなる．よって$\dim A\leq d+1$となり，示された．
\end{proof}

\begin{thm}
	Noether局所環$(A,\ideal{m})$において，$\ideal{m}$進完備化を$\widehat{A}$とすると$\dim\widehat{A}=\dim A$である．
\end{thm}

\begin{proof}
	\ref{lem:完備化に関してのもろもろの補題}より$A/\ideal{m}^n=\widehat{A}/{\widehat{\ideal{m}}}^n$であるので，$\chi_{\ideal{m}}(n)=\chi_{\widehat{\ideal{m}}}(n)$が成り立つ
\end{proof}

\begin{prop}\label{prop:イデアルの高さと生成系の個数}
	Noether環$A$のイデアル$I$について，$\idht I=r$ならばある$\nitem[r]{f}\in I$が存在して，任意の$1\leq i\leq r$について$\idht (\nitem[i]{f})=i$が成り立つ．
\end{prop}

\begin{proof}
	まず，$f_1$を$A$の零因子で単元でもない元とすると，Krullの単項イデアル定理より$\idht (f_1)=1$である．そこで，ある$i<r$について$\nitem[i]{f}$がすべての$1\leq j\leq i$について$\idht (\nitem[j]{f})=j$となるように選ばれているとする．素イデアル$P\in V(\nitem[i]{f})$について$\idht P=i$であるものは$(\nitem[i]{f})$の極小素因子なので\ref{cor:Noether環の極小素イデアルは有限個}より有限個しかない．また，$I\subsetneq P$であるので，Prime avoidance（\ref{lem:Prime avoidance}）より$f_{i+1}\in I$を$f_{i+1}\not\in\bigcup_{P\in V(\nitem[i]{j}),\idht P=j} P$となるようにとることができる．すると$\idht (\nitem[i+1]{f})=i+1$が成り立つ．よって帰納的に主張が従う．
\end{proof}

\begin{thm}
	環$A$について，$\dim A+1\leq\dim A[X]\leq 2\dim A+1$が成り立つ．
\end{thm}

\begin{proof}
	$\dim A+1\leq\dim A[X]$は明らかである．$\dim A[X]=d$とおこう．$A[X]$の素イデアル鎖$P_0\subsetneq P_1\subsetneq\dots\subsetneq P_d$について，$P_i'=P_i\cap A$とおいて$A$の素イデアル鎖$P_0'\subset P_1'\subset\dots\subset P_d'$を考える．この鎖の長さの取りうる値の最小値を求めよう．
	
	$P\in\spec A[X]$と$P'=P\cap A\in\spec A$を考える．積閉集合$A-P'$による$A，A[X]$の局所化はそれぞれ$A_P',A_P'[X]$である．特に$\spec A_P'[X]$は$\mkset{Q\in\spec A[X]}{(Q\cap A)\subset P'}$と対応する．また，$A_P'[X]$において$V(P'A_P'[X])$は$\spec (A_P'[X]/P'A_P'[X])=\spec (k(P)[X])$と対応するので，これらから$P$について$\mkset{Q\in\spec A[X]}{Q\cap A=P'}$からなる$A[X]$の素イデアル鎖の長さは高々1である．
	
	さて，$A$の素イデアル鎖$P_0'\subset\dots\subset P_d'$にもどると，もし$P_{i-1}'=P_i'$ならば先の議論より$P_{i-2}',P_{i+1}'$は$P_i'$と異なる．よってこの鎖は最短でも長さが$d$が偶数なら$d/2$，奇数なら$(d-1)/2$である．よって$(d-1)/2\leq \dim A$すなわち$d\leq 2\dim A+1$が成り立つ．
\end{proof}

次の結果は\ref{cor:多項式環の次元}の拡張である．

\begin{cor}\label{cor:Noether多項式の次元}
	$A$がNoether環ならば，$\dim A[X]=\dim A+1$が成り立つ．帰納的に$\dim A[X_1,\dots,X_n]=\dim A+n$である．
\end{cor}

\begin{proof}
	$d=\dim A[X]$としたとき，$A[X]$の素イデアル鎖$P_0\subsetneq P_1\subsetneq\dots\subsetneq P_d$について，先の定理と同様に$A$の素イデアル鎖$P_0'\subset\dots\subset P_d'$を考える．このとき$d-1\leq\idht P_d'$を示したい．
	
	$P'\in\spec A$について，$P'A[X]$を係数がすべて$P'$の元である多項式全体とすると，これは$A[X]$の素イデアルになる．$\idht P'=r$とし，$A$の素イデアル鎖$Q_0'\subsetneq Q_1'\subsetneq\dots\subsetneq Q_r'=P'$を考えよう．このとき$Q_0'A[X]\subsetneq Q_1'A[X]\subsetneq\dots\subsetneq Q_r'A[X]$は$A[X]$の素イデアル鎖になるので$r\leq\idht P'A[X]$が成り立つ．また$\idht P'=r$より，$P$はある$f_1,\dots,f_r$について$I=(\nitem[r]{f})$の極小素イデアルである．このとき$P'A[X]$は$I[X]$の極小素イデアルになるので，Krullの標高定理より$\idht P'A[X]\leq r$である．
	
	すると，$A$の素イデアル鎖$P_0'\subset\dots\subset P_d'$において$\idht P_d'=\idht P_d'A[X]$であり，$P_d'A[X]\cap A=P_d\cap A$であるので，$P_d'A[X]\subset P_d$でありかつ前定理の議論からその間に素イデアルはない．よって$d-1\leq\idht P_d'A[X]=\idht P_d'\leq\dim A$である．よって$d\leq\dim A+1$が従う．
\end{proof}

\section{正則環}

以後２つの節，正則環とCohen--Macaulay環については，深い結果を証明するにはホモロジー代数の考え方が不可分なので，定義とそこから予見される性質を紹介するに留める．

Noether局所環$(A,\ideal{m},k)$について，$\dim A=d$とすると$A$の$\ideal{m}$準素イデアルは少なくとも$d$個の元で生成される．ちょうど$d$個の元で$\ideal{m}$準素イデアルが生成されているときを考えよう．
\begin{defi}[巴系]\index{ぱけい@巴系}
	$(A,\ideal{m})$を$d$次元Noether局所環とする．$x_1,\dots,x_d\in\ideal{m}$が$\ideal{m}$準素イデアルを生成するとき$x_1,\dots,x_d$を$A$の\textbf{巴系}(system of parameters)という．
\end{defi}

また\ref{prop:Atimac_prop_2.8}より，$\ideal{m}$を生成するのに必要な元の個数は$\dim_k\ideal{m}/\ideal{m}^2$である．$\dim_k\ideal{m}/\ideal{m}^2$を$A$の\textbf{埋め込み次元}(embedding dimension)といい$\emdim A$と表す．次元定理より$\dim A\leq\emdim A$が成り立つ．等号が成り立つとき，すなわち$\ideal{m}$が$\dim A$個の元で生成されているとき$A$を\textbf{正則局所環}という．

\begin{defi}[正則局所環]\index{せいそくきょくしょかん@正則局所環}
	$(A,\ideal{m})$をNoether局所環とする．$d=\dim A$個の元$x_1,\dots,x_d\in A$が存在して$\ideal{m}=(\nitem[d]{x})$となっているとき$A$を\textbf{正則局所環}(regular local ring)といい，$\ideal{m}$を生成する巴系を\textbf{正則巴系}という．
\end{defi}

環$A$のすべての素イデアル$P$による局所化$A_P$が正則局所環であるような$A$を，\textbf{正則環}(regular ring)という．\index{せいそくかん@正則環}
\begin{prop}\label{prop:正則局所環は落ちる}
$d$次元Noether局所環$(A,\ideal{m})$について，$x_1,\dots,x_i$が$A$の正則巴系の１部分であることと$A/(x_1,\dots,x_i)$が$d-i$次の正則局所環であることは同値．
\end{prop}

\begin{proof}
	\begin{eqv}
		\item $A/(x_1,\dots,x_i)$の極大イデアルは$x_{i+1},\dots,x_n$の像で生成されており，\ref{prop:標高定理の系}より$\dim A/(x_1,\dots,x_i)=d-i$である．よって正則局所環となる．
		
		\item $A/(x_1,\dots,x_i)$の極大イデアル$\ideal{m}'=\ideal{m}/(x_1,\dots,x_i)$が$y_1,\dots,y_{n-i}$の像で生成されているとすると$\ideal{m}=(x_1,\dots,x_i，y_1,\dots,y_{n-i})$である．
	\end{eqv}
\end{proof}

\begin{thm}\label{thm:正則局所環は整域}
	正則局所環$(A,\ideal{m})$は整域である．
\end{thm}

\begin{proof}
	$\dim A$についての帰納法で示す．$\dim A=0$のときは$A$が体であるので明らか．$\dim A\geq 1$とし，$\dim A-1$次までの正則局所環は整域であると仮定する．$A$の高さ$0$の素イデアルを$P_1,\dots,P_r$とする．\ref{prop:局所環がm^n=0ならArtin}より$\ideal{m}\not\subset\ideal{m}^2$であり$\ideal{m}\not\subset P_i$であるので，Prime avoidanceよりある$x\in\ideal{m}$が存在して$x\not\in\ideal{m},P_1,\dots,P_r$が成り立つ．すると$x$の$\ideal{m}/\ideal{m}^2$における像$\bar{x}$は$0$でないので延長して$\{\bar{x}，\bar{y_1},\dots,\bar{y_{n-1}}\}$を$\ideal{m}/\ideal{m}^2$の基底にできる．このとき$x,y_1,\dots,y_{n-1}$は$A$の正則巴系となるので，前命題より$A/xA$は$n-1$次元の正則局所環である．仮定より整域なので$(x)$は素イデアル．すると$P_i$たちは極小なので$P_i\subset(x)$となる$i$がある．すると任意の$y\in P_i$について$y=ax\in P_i$となる$a\in A$が存在し，$x\not\in P_i$なので$a\in P_i$である．よって$P_i=xP_i$となり，中山の補題から$P_i=0$である．よって$A$は整域である．
\end{proof}

\ref{thm:DVRの特徴づけ}より次の結果が従う．

\begin{cor}
	$(A,\ideal{m})$が$1$次元の正則局所環であることとDVRであることは同値．
\end{cor}

DVRは整閉なので，1次元の正則局所環は整閉である．またより強くDVRはUFDでもあるが，次の結果が知られている．

\begin{thm}[Auslander--Buchsbaumの定理]\index{#Auslander--Buchsbaumのていり@Auslander--Buchsbaumの定理}\label{prethm:Auslander-Buchsbaum}
	正則局所環はUFDである．
\end{thm}

特にすべての正則局所環は整閉整域である．この結果の証明にはホモロジー代数的手法を本質的に必要とするため，ホモロジー代数を導入した後に証明を与える（\ref{thm:Auslander--Buchsbaumの定理}）．また，一見するとイデアル論の範疇で（ひょっとすると簡単に？）示せそうに見えるが，ホモロジー代数を要する結果として；

\begin{thm}[Serreの定理]\index{#Serreのていり@Serreの定理}\label{prethm:Serre}
	$A$を正則局所環とすると，任意の$P\in\spec A$について$A_P$も正則局所環である．
\end{thm}
がある（証明は\ref{thm:Serreの定理}）．この定理の証明はSerreによる方法以外には証明法が知られていない（\cite{goto}）．このように1960年代は，Serre, Auslander, Bachsbaum, Bass, Grothendieck らによってホモロジー的な手法が本格的に導入され，可換環論は大規模に発展することとなった．

次の節ではホモロジー代数を導入する前に，現在の可換環論の中心をなすCohen--Macaulay性について紹介することにする．

\section{Cohen--Macaulay 加群}

重要な局所環のクラスの１つにCohen--Macaulay\textbf{環}（略してCM\textbf{環}と書くことも多い）がある．Cohen--Macaulay環は現在の可換環論で中心的な存在の１つであり，この節と続くもう１つの節（Cohen--Macaulay環について述べる）ではホモロジー代数を（ほとんど）要しない範囲で性質をまとめておこう．まずそのために\textbf{正則列}と\textbf{深さ}を導入する．

\begin{defi}[正則元]
	$A$加群$M$について，$a\in A$が$M$に非例因子として作用する，すなわち任意の$0\neq x\in M$について$ax\neq0$であるとき，$a$は$M$\textbf{正則}(regular)であるという．
\end{defi}

\begin{defi}[正則列]\index{せいそくれつ@正則列}
	$A$をNoether環とし，$M$を有限生成$A$加群とする．$a_1,\dots,a_r\in A$が任意の$1\leq i\leq r$について$a_i$が$M/(a_1,\dots,a_{i-1})M$正則であるとき，$a_1,\dots,a_r$を$M$\textbf{正則列}(regular sequence)という．
\end{defi}

例えば体上の多項式$A=k[X_1,X_2,X_3]$において$f_1=X_1(X_2-1),f_2=X_2,f_3=X_3(X_1-1)$とすると$f_1,f_2,f_3$は$A$正則列をなす．ところが$X_1$は$A/(f_1)$において$0$ではないが，$f_3X_3$は$0$であるので$f_1,f_3,f_2$は$A$正則列ではない．このように正則列は順序を考慮する必要があるが，局所環においては極大イデアルの元について順序によらないことが知られている．ここではより強く$\rad A$の元においてそのことを示そう．

\begin{lem}\label{lem:正則元と素因子}
	Noether環$A$上の加群$M$において$a\in A$が$M$正則でありかつ$\bigcap a^nM=0$であるものとする．このとき$M$の素因子$P\in\ass M$について$P+(a)\subset Q$となる$Q\in\ass (M/aM)$が存在する．
\end{lem}

この補題の仮定はKrullの交叉定理（\ref{cor:Krullの交叉定理の系}）より$a\in\rad A$のとき満たされる．

\begin{proof}
	$x\in M$によって$P=\ann (x)$とかける．ここで$\bigcap a^nM=0$より，ある$k\geq0$が存在して$x\in a^kM$かつ$x\not\in a^{k+1}M$である．このとき$y\in M$によって$x=a^ky$と書けているとすると$y\not\in aM$である．ここで$\bar{y}$を$y$の$M/aM$における像とすると，$a$が$M$正則なので$(P+(a))\bar{y}=0$が成り立つ．これは$P+(a)\subset\ann (\bar{y})$を意味するが，\ref{prop:素因子の存在}よりある$Q\in\ass (M/aM)$が存在する．
\end{proof}

\begin{prop}
	Noether環$A$上の有限生成加群$M$において$a_1,\dots,a_r\in\rad A$とする．このとき$a_1,\dots,a_r$が$M$正則列ならその並べ替えも$M$正則である．
\end{prop}

\begin{proof}
	まず２つの場合に帰着できることをみよう．$a_1,\dots,a_i,a_{i+1},\dots,a_r$が$M$正則列であるとする．$N=M/(a_1,\dots,a_{i-1})M$とおくと$a_i$は$N$正則であり，$a_{i+1}$は$N/a_iN=M/(a_1,\dots,a_i)M$正則である．このとき$a_1,\dots,a_{i+1},a_i,\dots,a_r$が$M$正則列であることをみるには$a_{i+1}$が$N$の，$a_i$が$N/a_{i+1}N=M/(a_1,\dots,a_{i-1},a_{i+1})M$正則であることを示せばよい．
	
	よって$a_1$が$M$の，$a_2$が$M/a_1M$正則なら$a_2$が$M$の，$a_1$が$M/a_2M$正則であることを示せば十分である．まず$a_2$が$M$の零因子とすると，\ref{prop:素因子の存在}よりある$P\in\ass M$に対して$a_2\in P$である．ここで$a_1\in\rad A$より，Krullの交叉定理から$\bigcap a_1^nM=0$となるので，補題から$P+(a_1)\subset Q$となる$Q\in\ass (M/a_1M)$がある．すると$a_2\in P\subset Q$だから$a_2$が$M/a_1M$正則であることに矛盾する．よって$a_2$は$M$正則．また$a_1$が$M/a_2M$の零因子とすると，ある$x\not\in a_2M,y\in M$について$a_1x=a_2y$だが，このとき$a_2y\in a_1M$より$a_2$が$M/a_1M$正則だから$y\in a_1M$である．$y=a_1z$とおくと$a_1(x-a_2z)=0$となり，$a_1$は$M$正則なので$x=a_2z$となって矛盾する．よって$a_1$は$M/a_2M$正則である．
\end{proof}

\begin{cor}
	Noether局所環$(A,\ideal{m})$上の有限生成加群$M$について，$a_1,\dots,a_r\in\ideal{m}$が$M$正則列であるとき，その並べ替えも$M$正則列である．
\end{cor}

次元と関連して，加群の\textbf{深さ}というものを導入しよう．

\begin{defi}[深さ]\index{ふかさ@深さ}
	$A$をNoether環とし，$M$を有限生成$A$加群とする．$A$のイデアル$I$について$IM\neq M$であるとき，$I$の元からなる$M$正則列の長さの最大値を$M$の$I$における\textbf{深さ}(depth)といい，$\mdepth_I M$とかく．$IM=M$であるときは$\mdepth_I M=\infty$と定義する．特に$A$が極大イデアルが$\ideal{m}$である局所環のとき，$\ideal{m}$における$M$の深さを$\mdepth M$とかいて単に$M$に\textbf{深さ}という．
\end{defi}

この定義における$M\neq IM$という条件は，$M\neq0$のとき$(A,\ideal{m})$が局所環ということと中山の補題から$I\subset\ideal{m}$と同値である．

さて，Noether局所環$(A,\ideal{m})$について$\dim A\leq \emdim A=\dim_k\ideal{m}/\ideal{m}^2$であり，これの等号が成り立つものを正則局所環というのであった．深さは環の次元を下から抑えるものとなっている．そのことを示そう．

\begin{prop}
	Noether局所環$(A,\ideal{m})$と，有限生成$A$加群$M\neq0$について，任意の$P\in\ass M$に対し；
	\[\mdepth M\leq\dim A/P\]
	が成り立つ．
\end{prop}

\begin{proof}
	$\mdepth M$についての帰納法で示す．まず$\mdepth M=0$のときは明らかに成り立っている．$\mdepth M=r$とおき，$\mdepth M'\leq r-1$となる$M'$について成り立っていると仮定しよう．$M$正則列$a_1,\dots,a_r$を考える．このとき$\mdepth (M/a_1M)=r-1$である．また任意の$P\in\ass M$について，\ref{lem:正則元と素因子}から$P+(a_1)\subset Q$となる$Q\in\ass (M/a_1M)$が存在し，$a_1\not\in P,a_1\in Q$であるから$P\subsetneq Q$である．よって$\dim A/Q<\dim A/P$が成り立つ．帰納法の仮定から$r-1=\mdepth (M/a_1M)\leq\dim A/Q<\dim A/P$であるので，$r\leq\dim A/P$であることがわかる． 
\end{proof}

\begin{cor}
	Noether局所環$(A,\ideal{m})$と，有限生成$A$加群$M\neq0$について，$\mdepth M\leq\dim M$である．
\end{cor}

これにより次の定義を導入する．

\begin{defi}[Cohen--Macaulay加群]\index{#Cohen--Macaulayかぐん@Cohen--Macaulay加群}
	Noether局所環$(A,\ideal{m})$上の有限生成加群$M$について，$\dim M=\mdepth M$であるとき$M$をCohen--Macaulay\textbf{加群}という．以後単にCM加群とかく．
\end{defi}

まず，わかりやすいご利益として定義から次が従う．

\begin{prop}\label{prop:CM加群は非孤立素因子を持たない}
	$M$をNoether局所環$(A,\ideal{m})$上のCM加群とすると，$M$は非孤立素因子を持たない．
\end{prop}

\begin{proof}
	一般に$P\in\ass M$なら$\mdepth M\leq\dim A/P\leq\dim M$だが，$M$がCMなので$\dim A/P$は$P$によらず$\mdepth M=\dim M$に等しい．
\end{proof}
これからCM性についての考察を進めていきたいところではあるが，加群の深さについては Ext と呼ばれる関手を使った言い換えがあり，それにより扱いが簡明になるところがある．ホモロジー代数を仮定しないここでは，次の補題；

\begin{lem}\label{lem:depth M/aM=depth M-1}
	$(A,\ideal{m})$をNoether局所環とし，$M$を$A$上の有限生成加群とする．$a\in I$が$M$正則ならば，イデアル$I\subset\ideal{m}$について；
	\[\mdepth_I (M/aM)=\mdepth_I M-1\]
	が成り立つ．
\end{lem}

を仮定して（証明は\ref{lem:depth M/aMについての証明}で与える），CM性のご利益について見ていくことにしよう．まず補題を用意する．

\begin{lem}\label{lem:dim M/aM=dim M-1}
	$(A,\ideal{m})$をNoether局所環とし、$M\neq0$を有限生成$A$加群とする．$a\in\ideal{m}$が$M$正則元であるとき，$\dim M/aM=\dim M-1$が成り立つ．
\end{lem}

\begin{proof}
	$a$は$A/\ann M$の非零因子なので，\ref{prop:dim A/xA=dim A-1}より$\dim M-1=\dim A/\ann M-1=\dim A/(\ann M+(a))$が成り立つ．また$\dim M/aM=\dim A/\ann(M/aM)$であるので，$\dim A/(\ann M+(a))=\dim A/\ann(M/aM)$であることを示せばよい．それには$P\in\spec A$が$\ann M+(a)\subset P$であることと$\ann(M/aM)\subset P$であることが同値であることを示せば十分である．
	
	容易に$\ann(M/aM)\subset P$なら$\ann M\subset P$かつ$a\in P$であることがわかる．一方で$\ann M\subset P$かつ$a\in P$ならば$M_P\neq0$であり，また$a\in P$だから$(M/aM)_P=M_P/aM_P$であり，$a/1\in\rad (A_P)=PA_P$だから中山の補題より$M_P/aM_P\neq0$である．よって$P\in\supp M/aM$すなわち$\ann(M/aM)\subset P$となり，求める等式が示された．
\end{proof}

この２つの補題から帰納法により容易に次が従う．
\begin{cor}\label{cor:CMの正則列による商もCM}
	$M$をNoether局所環$(A,\ideal{m})$上のCM加群とする．$a_1,\dots,a_r\in\ideal{m}$が$M$正則列なら（$r$は$\mdepth M$と一致しているとは限らない），$M/(a_1,\dots,a_r)M$も次元が$\dim M-r$のCM加群である．
\end{cor}

最後に技術的な命題たちを述べておこう．

\begin{lem}\label{lem:depth 0とass}
	$A$をNoether環，$M$を$A$のイデアルとし$I$を$IM\neq M$となる$A$のイデアルとする．$\mdepth_I M=0$，すなわち任意の$x\in I$が$M$の零因子であることと，ある$P\in\ass M$が存在して$I\subset P$であることは同値．
\end{lem}

\begin{proof}
	$(\Longleftarrow)$は明らか．$(\Longrightarrow)$は対偶を示す．任意の$P\in\ass M$について$I\not\subset P$であると仮定する．$\ass M$は有限だからPrime avoidance より$I\subsetneq\bigcup_{P\in\ass M}P$であり，\ref{cor:加群の零因子は素因子と等しい}より$x\in I$で$M$正則元となるものが存在する．
\end{proof}

\begin{prop}\label{prop:CMの局所化もCM}
	$M$をNoether局所環$(A,\ideal{m})$上のCM加群とすると，任意の$P\in\supp M$について；
	\[\mdepth_P M=\mdepth_{PA_P} M_P=\dim M_P\]
	が成り立つ．特に$M_P$もCM $A_P$加群である．
\end{prop}

\begin{proof}
	一般に$\mdepth_P M\leq\mdepth_{PA_P}M_P\leq\dim M_P$であることを容易に確かめることができる．よって$\dim M_P\leq\mdepth_P M$であることを示せばよい．
	
	$\mdepth_P M$についての帰納法で示そう．まず$\mdepth_P M=0$ならば，
	補題よりある$\in\ass M$が存在して$P\subset Q$である．ここで\ref{lem:素因子と局所化}より$V(\ann (M_P))=\ass M_P=\mkset{Q\in\ass M}{Q\subset P}\neq\emptyset$であり，$M$がCM加群だから非孤立素因子を持たないので$V(\ann(M_P))=PA_P$となり，$\dim M_P=\dim A_P/PA_P=0$である．さて$\mdepth_P M=r>0$として，$r-1$まで正しいとする．定義より$a\in P$で$M$正則なものがある．ここで\ref{lem:depth M/aM=depth M-1}より$\mdepth_P M/aM=\mdepth_P M-1$であり，帰納法の仮定と\ref{lem:dim M/aM=dim M-1}から$\mdepth_P M/aM=\dim (M/aM)_P=\dim M_P/aM_P=\dim M_P-1$である．よって$\mdepth_P M=\dim M_P$であることがわかり，証明が完了する．	
\end{proof}

この命題によりCM局所環$(A,\ideal{m})$の局所化$A_P$もまた$\mdepth A_P=\idht P$となるCM局所環である．
\section{Cohen--Macaulay環と鎖状環}

正則環と同様に，局所環でない環は局所化により局所環とできることから次の定義をする．
\begin{defi}[Cohen--Macaulay環]\index{#Cohen-Macaulayかん@Cohen--Macaulay環}
	Noether環$A$について，任意の$P\in\spec A$による局所化$A_P$が$A_P$加群としてCohen--Macaulay加群となるとき$A$をCohen--Macaulay\textbf{環}という．
\end{defi}

明らかに体はCM環である．また簡単な計算により１次元Noether整域はCM環であることがわかる．特にPID，Dedekind整域などはCM環である．この節では，CM環の簡単な性質を見るとともに，正則局所環やCM環上の多項式環がCM環であること，またすべてのCM環が強鎖状環であることを示そう．

\begin{prop}
	環$A$について，鎖状性は局所的な性質である．すなわち$A$が鎖状環であることと，任意の$P\in\spec A$について$A_P$が鎖状環であることは同値．
\end{prop}

証明は定義から明らかであろう．この性質によりCM局所環に帰着することができる．

\begin{thm}
	$(A,\ideal{m})$をCM局所環とする．$A$において弱次元公式（\ref{defi:弱次元公式}）が成り立ち，また$A$は鎖状環である．
\end{thm}

\begin{proof}
	まず弱次元公式が成り立つことを示そう．任意の$P\in\spec A$をとり，$\idht P=n$とする．\ref{prop:CMの局所化もCM}より$A_P$もCM局所環で$\idht P=\mdepth_{PA_P} A_P=\mdepth_P A$であるので，$A$正則列$a_1,\dots,a_n\in P$が存在する．$I=(a_1,\dots,a_n)$とおくと，\ref{cor:CMの正則列による商もCM}より$A/I$は$\dim A/I=\dim A-n$となるCM局所環である．また$a_1,\dots,a_n$は$A$正則なので$0<\idht(a_1)<\idht(a_1,a_2)<\cdots$であるから，$n\leq\idht I$が成り立つ．また$\idht I\leq\idht P=n$より$\idht I=\idht P$となり，$P$は$I$の極小素イデアルである．よって$P$は$A/I$の素因子なので，$\dim A/P=\dim A/I=\dim A-n$が成り立つ．よって$\dim A/P=\coht P$だから$\idht P+\coht P=\dim A$である．
	
	次に鎖状であることを示す．任意の素イデアル鎖$P\subsetneq Q$をとる．局所化$A_Q$もCM局所環なので，弱次元公式が成り立つから$\idht Q-\idht P=\dim A_Q/PA_Q$
	が成り立つ．そこで$P\subsetneq P_1\subsetneq \dots\subsetneq P_s=Q$を飽和した素イデアル鎖とすると，$P_i\subsetneq P_{i+1}$について同様に$\idht P_{i+1}=\idht P_i+\dim A_{P_i}/P_{i-1}A_{P_i}=\idht P_i+1$が成り立つ．よって$\idht Q=\idht P+s$であり，$s=\dim A_Q/PA_Q$がわかるので$A$は鎖状である．
\end{proof}

\begin{cor}
	CM環は鎖状環である．
\end{cor}

次にCM環においては巴系と正則列の間に相互によい関係があることを見よう．まず一般に正則局所環はCM環であることを確認しておく．

\begin{prop}[Cohen]
	正則局所環はCM環である．
\end{prop}

\begin{proof}
	$(A,\ideal{m})$を正則局所環とし，$\dim A=n$とおく．$x_1,\dots,x_d\in\ideal{m}$を正則巴系としよう．このとき\ref{prop:正則局所環は落ちる}，\ref{thm:正則局所環は整域}によりこれらが$A$正則列をなすことがわかる．
\end{proof}

CM環という条件を仮定すると，正則列と巴系の概念が一致する．

\begin{prop}\label{prop:CM局所環での正則列と巴系}
	$(A,\ideal{m})$をCM局所環とすると，$a_1,\dots,a_r\in\ideal{m}$について，以下の命題；
	\begin{sakura}
		\item $a_1,\dots,a_r$は$A$正則列をなす．
		\item 任意の$1\leq i\leq r$について$\idht (a_1,\dots,a_i)=i$である．
		\item $\idht (a_1,\dots,a_r)=r$である．
		\item $a_1,\dots,a_r$は$A$の巴系の一部分をなす．
	\end{sakura}
	は同値である．	
\end{prop}

\begin{proof}	
	CM性が必要になるのは(iv)$\Longrightarrow$(i)のみであることを注意しておく．
	\begin{eqv}[4]
		\item 
		$a_1,\dots,a_r\in\ideal{m}$を$A$正則列とすると，$0<\idht(a_1)<\idht(a_1,a_2)<\cdots$よりKrullの標高定理（\ref{thm:Krullの標高定理}）から$1\leq i\leq r$について$\idht (a_1,\dots,a_i)=i$である．
		\item 自明．
		\item もし$\dim A=r$なら，$(a_1,\dots,a_r)$の極小素イデアルは$\ideal{m}$のなので$\sqrt{(a_1,\dots,a_r)}=\ideal{m}$となり$(a_1,\dots,a_r)$は$\ideal{m}$準素だから$\nitem[r]{a}$は巴系をなす．また$r<\dim A$なら$\ideal{m}$は$(a_1,\dots,a_r)$の極小素イデアルではないので，Prime avoidanceから$a_{r+1}\in\ideal{m}$を$(a_1,\dots,a_r)$のすべての極小素イデアルに含まれないようにとれる．このとき$\idht(a_1,\dots,a_r,a_{r+1})>r$なので，高さが$\dim A$と一致するまで続けることで$a_1,\dots,a_r$は$A$の巴系の一部分であることがわかる．
		\item $\dim A=n$として，$a_1,\dots,a_n$が巴系なら$A$正則であることを示せばよい．$n$についての帰納法を用いる．まず$n=1$のとき，$a_1$が巴系であるとする．ここで$a_1$が$A$正則でない，すなわち$a_1x=0$となる$x\neq0\in A$が存在するとすると，\ref{prop:素因子の存在}から$a_1\in P$となる$P\in\ass A$が存在するが，\ref{prop:CM加群は非孤立素因子を持たない}の証明からわかるように$\dim A/P=1$であるので，$P\subsetneq\ideal{m}$を意味する．これは$(a_1)$が$\ideal{m}$準素であることに矛盾する．よって$a_1$は$A$正則である．
		
		次に$n-1$まで正しいとする．$A$の巴系$a_1,\dots,a_n$について，$a_1$が$A$正則元でないと仮定すると，$n=1$の場合と同様に$a_1\in P$となる$P\in\ass A$が存在して$\dim A/P=n$である．一方で$\sqrt{(a_1,\dots,a_n)}=\ideal{m}$であるので，$A/P$において$\sqrt{(\bar{a_2},\dots,\bar{a_n})}=\ideal{m}$であり，次元定理から$\dim A/P\leq n-1$が言えるがこれは矛盾である．ゆえに$a_1$は$A$正則で，$A/a_1A$は$a_2,\dots,a_n$の像を巴系とする$n-1$次のCM局所環である．よって帰納法の仮定から$a_2,\dots,a_n$の像は$A/a_1A$の正則列であり，$a_1,\dots,a_n$は$A$の正則列をなす．
	\end{eqv}
\end{proof}

次にCM環上の多項式環もCM環になることを示そう．そのために，CM環についてMacaulay,Cohenらが考察していた当時の定義を紹介しよう．

\begin{defi}[純性定理]\index{じゅんせいていり@純性定理}\index{じゅんいである@純（イデアル）}
	Noether環$A$のイデアル$I$について，任意の$P\in\ass A/I$の高さが$\idht I$に等しいとき，$I$は\textbf{純}(unmixied)であるという．特にNoether環$A$について$r$個の元で生成されるイデアル$I=(a_1,\dots,a_r)$について$\idht I=r$ならば$I$は必ず純であるとき，$A$において\textbf{純性定理}(unmixedness theorem)が成り立つという．
\end{defi}

Krullの標高定理（\ref{thm:Krullの標高定理}）より，$r$個の元で生成され高さが$r$のイデアル$I$の極小素イデアルの高さはすべて$r$であるので，$I$が純であるということは非孤立素因子を持たないということを意味する．Macaulay (1916)は体上の多項式環について純性定理が成り立つことを，Cohen (1946)は正則局所環について純性定理が成り立つことを証明した．Noether環$A$について純性定理が成り立つことと，（本書の意味で）CM環であることは同値であり，これがCM環の由来である．正則局所環がCM環であることは（Cohenは純性定理が成り立つことを証明したためだいぶ異なる道筋で）上に示した通り．CM環の定義と純性定理が成り立つことを同値であることを確かめておこう．

\begin{thm}
	Noether環$A$について，純性定理が成り立つこととCM環であることは同値である．
\end{thm}

\begin{proof}
	\begin{eqv}
		\item 任意の$P\in\spec A$をとり，$\idht P=r$とする．\ref{prop:イデアルの高さと生成系の個数}より$a_1,\dots,a_r\in P$を$\idht(a_1,\dots,a_i)=i$がすべての$1\leq i\leq r$で成り立つようにとれる．このとき$a_1,\dots,a_r$が$A_P$正則列になる．各$i$について純性定理により$(a_1,\dots,a_i)$の素因子の高さはすべて$i$であるので，特に$a_{i+1}$を含まない．すると\ref{cor:加群の零因子は素因子と等しい}により$a_{i+1}$は$A/(a_1,\dots,a_i)$で正則である．よって$\mdepth A_P=r=\dim A_P$であり$A_P$はCM局所環である．すなわち$A$はCM環．
		\item $I=(a_1,\dots,a_r)$が$\idht I=r$であるとする．$P\in\ass A/I$をとり，$P$が極小でないと仮定する．$P$を含む極大イデアル$\ideal{m}$で局所化して考える．このとき$IA_{\ideal{m}}$はすくなくとも素因子$P'A_{\ideal{m}}\subsetneq PA_{\ideal{m}}$を持つ．ところが\ref{prop:CM局所環での正則列と巴系}より$a_1,\dots,a_r$は$A_{\ideal{m}}$の正則列であり，\ref{cor:CMの正則列による商もCM}より$A_{\ideal{m}}/IA_{\ideal{m}}$もCM局所環である．よって$IA_{\ideal{m}}$の素因子はすべて極小でなければならないので矛盾である．よって純性定理が成り立つ．
	\end{eqv}
\end{proof}

この証明の$(\Longleftarrow)$に注目すると，$A$の極大イデアルによる局所化がCM局所環でありさえすれば純性定理が成り立つ．よって次の系が従う．

\begin{cor}
	Noether環$A$がCM環かどうかを確かめるには任意の極大イデアルによる局所化がCM局所環であるかどうかを確かめれば十分である．
\end{cor}

CM環上の多項式環がCM環であること，そしてCM環は強鎖状環であることを証明してこの節を締めくくろう．

\begin{thm}
	$A$をCM環とすると，$A$上の多項式$A[X_1,\dots,X_n]$もCM環である．
\end{thm}

\begin{proof}
	先の系により$A[X]$の極大イデアル$\ideal{m}'$による局所化がCM局所環であることを示せば十分である．まずは$A$が局所環の場合に帰着できることを見る．$A\cap\ideal{m}'=\ideal{m}\in\spec A$とおくと，自然な対応で；
	\[A[X]_{\ideal{m}'}=(A_{\ideal{m}}[X])_{\ideal{m}'A_{\ideal{m}}[X]}, A_{\ideal{m}}[X]/(\ideal{m}'A_{\ideal{m}}[X])=A[X]/\ideal{m}'\]であり，$A$を局所環と仮定してよいことがわかる．また$\ideal{m}'A_{\ideal{m}}[X]\cap A_{\ideal{m}}=\ideal{m}A_{\ideal{m}}$であるので，$\ideal{m}$も極大と仮定してよい．
	
	以上より，$A$が局所環であって，$A[X]$の極大イデアル$\ideal{m}'$が$\ideal{m}'\cap A=\ideal{m}\in\spm A$を満たすときに$A[X]_{\ideal{m}'}$がCM局所環であることを示せばよい．体$A/\ideal{m}$を$k$とおくと，準同型；
	\[\varphi:A[X]\to k[X];a_nX^n+\dots+a_0\mapsto \bar{a_n}X^n+\dots+\bar{a_0}\quad\text{（ $\bar{a_i}$は$a_i$の$A/\ideal{m}$における像．）}\]
	により環同型$A[X]/\ideal{m}A[X]\cong k[X]$がある．いま$\ideal{m}A[X]\subset\ideal{m}'$であり，$A[X]/\ideal{m}A[X]$は１次元の整域であることに注意すると$\ideal{m}'$の像は極大イデアルである．よってモニックで既約な$f'\in k[X]$によって生成されている．$f\in\ideal{m}'$を$\varphi(f)=f'$となるようにとると，$\ideal{m}'=\ideal{m}A[X]+(f)$である．よって$\ideal{m}=(a_1,\dots,a_r)$とすれば$A[X]$上$\ideal{m}'$は$a_1,\dots,a_r,f$で生成されている．またこれらは$A[X]$正則列をなす．$a_i$たちについては\ref{prop:CM局所環での正則列と巴系}から$A$正則列をなすことから従い，$f$は$A[X]/(a_1,\dots,a_r)A[X]=k[X]$でモニックなので正則である．よって$r+1\leq\mdepth_{\ideal{m}'}A[X]$であることがわかる．また$\ideal{m}'$は$r+1$個の元で生成されているからKrullの標高定理により$\dim A[X]_{\ideal{m}'}\leq r+1$である．これらに\ref{prop:CMの局所化もCM}をあわせて；
	\[\dim A[X]_{\ideal{m}'}\leq r+1\leq\mdepth_{\ideal{m}'}A[X]=\mdepth A[X]_{\ideal{m}'}\]
	がわかり，$A[X]_{\ideal{m}'}$はCM局所環である．	
\end{proof}

\begin{cor}[Macaulay]
	体上の多項式環$k[X_1,\dots,X_n]$はCM環である．
\end{cor}

\begin{cor}\label{cor:CM環は強鎖状}
	CM環は強鎖状環である．
\end{cor}

それでは，いよいよ次の章からは圏論とホモロジー代数を導入し，より現代的な手法を用いた可換環の考察についてみていこう．
